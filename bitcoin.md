# 比特币

- [比特币](#比特币)
  - [CIA：信息系统的安全等级的三个性质](#cia信息系统的安全等级的三个性质)
  - [电子商务的安全性](#电子商务的安全性)
  - [基础概念](#基础概念)
  - [核心概念](#核心概念)
    - [分布式账本](#分布式账本)
    - [区块链结构](#区块链结构)
    - [工作量证明](#工作量证明)
    - [最长链原则](#最长链原则)
    - [去中心网络](#去中心网络)

## CIA：信息系统的安全等级的三个性质

<!-- entry begin: CIA -->

- 机密性(Confidentiality) ：指只有用户可以获取信息
- 完整性(Intergrity) ：接收方接收的数据与发送方发送的数据一致
- 可用性(Availability) ：合法用户对信息和资源的使用不会被不正当的拒绝
  > 可以将以上三条性质带入上面的流程中去，看看是否符合这些性质，又是如何达到这些性质
  <!-- entry end -->

## 电子商务的安全性

<!-- entry begin: 电子商务安全性 -->

- 数据传输安全性：数据在传输过程中不会被窃取与篡改(对称加密技术,非对称加密技术与 hash 校验)
- 数据完整性 ：数据不会被篡改(由企业保证服务器安全，比特网中见后续)
- 身份验证 ：确认对方的真实身份(非对称加密技术)
- 不可抵赖性 ：交易双方在传输数据时，必须带有**自身特有**、**无法被别人复制**的信息，
以保证交易发生纠纷是有所对证(数字签名与数字证书)
<!-- entry end -->

## 基础概念

<!-- entry begin: bitcoin 基础概念 -->

- 首先得清楚**比特币**与**区块链**二者的关系：

  - 比特币是一种**计算机网络传输协议**，旨在*去中心化*
    > &emsp;思考一下，如今我们的大多数交易都是中心化的：微信支付以腾讯为中心，支付宝以阿里为中心，
    > 甚至我们用纸币也是以国家政府为中心。我们相信腾讯、阿里、国家可以保护我们的财产和交易，
    > 他们提供一个平台让大家更方便的交流。但所有这些都是基于信任的，我们相信他们不会搞些幺蛾子。  
    > &emsp;而比特币提供了一种交易网络系统，它是去中心化的——由全世界所有矿机来维护整个系统。
    > 这个分布式系统的运作不是基于你对它的信任，因为它是基于数学逻辑的。
  - 而区块链是是比特币的底层技术，它是一种**数据结构**(也可泛指一类技术)，旨在提供价值属性
    > &emsp;再思考一下，我们用来交易的东西是什么？一串数据流，一张纸，他们本身没有价值，
    > 是企业和国家告诉我们这些是有价值的，而他们则负责维护这些物品的价值属性。
    > 其中非常重要一条——不可复制性。如果你可以随意修改你支付宝上的余额，或者你可以随意印出堪比真钱的假钞，
    > 那它们就不可能有价值，天王老子说的都不算

- 比特币的基本组成：

  - 加密数字货币
  - 分布式账本
  - 去中心网络

- 核心问题：
  - 你是钱包主人？
  - 你的资产是正确的？
  - 去中心化分布式系统的运作？
  - 信息篡改
  - 双花问题
  - 信息同步

<!-- entry end -->

## 核心概念

![区块链](images/blockchain.jpg)

**分布式去中心系统核心思想是：利用已有的数据可以验证将有数据的正确性**

- 分布式账本：利用数字签名与交易记录确保交易合法且有效
- 区块链结构：利用区块链与梅克尔树保证历史不被篡改
- 工作量证明：验证算力竞争答案确认记账权是否有效

### 分布式账本

<!-- entry begin: bitcoin 分布式账本 -->

- 交易记录：
  - IN ：上次交易条款号
  - OUT ：目标账户
  - COUNT ：交易数目
  - 交易发起人(付费方)的数字签名
- 账户钱包：
  - 即用户私钥对应的公钥，也被称作钱包地址
  - 比特币中没有一个专门的地方存储你的账户余额，见下 UTXO，以太坊因为其它考虑而没有用 UTXO 的设计
- 账户余额：
_ 用户的资产即 UTXO(未使用的交易输出) > 在比特币系统中，所有输出(OUT)是你的地址的交易记录，它们的资产总和就是你的资产，确认余额正确性 > 只需要追溯到上次交易即可
_ 进行交易时，由付款者对它的一条 UTXO 签名，其中 OUT 为收款者，提交交易到比特币系统 > 动用的 UTXO 大于应付款，则可以将再加一个 OUT 指向自己的钱包地址进行“找零”操作
<!-- entry end -->

### 区块链结构

<!-- entry begin: bitcoin 区块链 -->

去中心的基础便是让各个节点可以验证数据的正确性：验证交易记录的正确性与区块记账权的正确性

- 上一区块 hash 值
  > 防止篡改。若试图篡改一个区块内容，则需要连着更改该区块之后的所有区块
- 交易记录
  > 以梅克尔树的形式存储该区块中的所有交易记录，该数据结构也具有防止篡改的特性
- <span id="nonce">Nonce</span> > 用于工作量证明
<!-- entry end -->

### 工作量证明

<!-- entry begin: bitcoin 工作量证明 -->

- 奖励机制
  - 维护全节点的矿机可获取创币交易(比特币的发行)，该奖励每四年减半(模拟黄金的开采)，故比特币总量不变
  - 收取交易的手续费，大概为 1%
- 记账权利
  - 将比特币网络中的未确认交易按梅克尔树组装成块，未纳入的交易往下顺延
- 工作量证明(重点)
  - 所有矿机进行算力竞争，首个胜出的矿机获取记账权
    > 算力竞争，即共同做一道数学题：找到一个值[Nonce](#nonce)，让接下来的区块的 hash 值的后缀
    > 为某一个值，这道题只有通过暴力破解，且会由整个比特币系统根据过去的数据动态调整以控制在 10 分钟左右
    > (硬件的算力在逐年提升)
- 整个流程描述为：算力竞争，获取记账权，创建区块并广播，获得奖励
<!-- entry end -->

### 最长链原则

<!-- entry begin: bitcoin 最长链原则 -->

- 广播的区块链遇到冲突会抛弃短链选择长链，所以会导致交易失败
- 交易 6 小时成功的不成文规则
<!-- entry end -->

### 去中心网络

<!-- entry begin: bitcoin 区中心网络 -->

- 全节点：存储所有交易信息的区块链
- 轻节点：只存储关链信息，其余联网取得
- 矿工节点：负责工作量证明赢取记账权的节点
<!-- entry end -->
